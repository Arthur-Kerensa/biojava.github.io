<h1 id="the-biojava-structure-data-model">The BioJava-structure data model</h1>

<p>A biologically and chemically meaningful data representation of
PDB/mmCIF.</p>

<h2 id="the-basics">The basics</h2>

<p>BioJava at its core is a collection of file parsers and (in some cases)
data models to represent frequently used biological data. The
protein-structure modules represent macromolecular data in a way that
should make it easy to work with. The representation is essentially
independ of the underlying file format and the user can chose to work
with either PDB or mmCIF files and still get an almost identical data
representation.</p>

<h2 id="the-main-hierarchy">The main hierarchy</h2>

<p>BioJava provides a flexible data structure for managing protein
structural data. The
<a href="http://www.biojava.org/docs/api/org/biojava/nbio/structure/Structure.html">Structure</a>
class is the main container.</p>

<p>A Structure has a hierarchy of sub-objects:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Structure
   |
   Model(s)
        |
        Chain(s)
            |
             Group(s) -&gt; Chemical Component Definition
                 |
                 Atom(s)
</code></pre>
</div>

<p>All structure objects contain one or more “models”. That means also
X-ray structures contain an “virtual” model which serves as a container
for the chains. The most common way to access chains will be via</p>

<div class="highlighter-rouge"><pre class="highlight"><code>        List&lt;Chain&gt;chains = structure.getChains();
</code></pre>
</div>

<p>This works for both NMR and X-ray based structures and by default the
first model is getting accessed.</p>

<h2 id="working-with-atoms">Working with atoms</h2>

<p>Different ways are provided how to access the data contained in a
<a href="http://www.biojava.org/docs/api/org/biojava/nbio/structure/Structure.html">Structure</a>.
If you want to directly access an array of
<a href="http://www.biojava.org/docs/api/org/biojava/nbio/structure/Atom.html">Atoms</a>
you can use the utility class called
<a href="http://www.biojava.org/docs/api/org/biojava/nbio/structure/StructureTools.html">StructureTools</a></p>

<div class="highlighter-rouge"><pre class="highlight"><code>    // get all C-alpha atoms in the structure
    Atom[] caAtoms = StructureTools.getAtomCAArray(structure);
</code></pre>
</div>

<h2 id="working-with-groups">Working with groups</h2>

<p>The
<a href="http://www.biojava.org/docs/api/org/biojava/nbio/structure/Group.html">Group</a>
interface defines all methods common to a group of atoms. There are 3
types of Groups:</p>

<ul>
  <li><a href="http://www.biojava.org/docs/api/org/biojava/nbio/structure/AminoAcid.html">AminoAcid</a></li>
  <li><a href="http://www.biojava.org/docs/api/org/biojava/nbio/structure/NucleotideImpl.html">Nucleotide</a></li>
  <li><a href="http://www.biojava.org/docs/api/org/biojava/nbio/structure/HetatomImpl.html">Hetatom</a></li>
</ul>

<p>In order to get all amino acids that have been observed in a PDB chain,
you can use the following utility method:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>            Chain chain = s.getChainByPDB("A");
            List&lt;Group&gt; groups = chain.getAtomGroups("amino");
            for (Group group : groups) {
                AminoAcid aa = (AminoAcid) group;

                // do something amino acid specific, e.g. print the secondary structure assignment
                System.out.println(aa + " " + aa.getSecStruc());
            }
</code></pre>
</div>

<p>In a similar way you can access all nucleotide groups by</p>

<div class="highlighter-rouge"><pre class="highlight"><code>            chain.getAtomGroups("nucleotide");
</code></pre>
</div>

<p>The Hetatom groups are access in a similar fashion:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>            chain.getAtomGroups("hetatm");
</code></pre>
</div>

<p>Since all 3 types of groups are implementing the Group interface, you
can also iterate over all groups and check for the instance type:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>            List&lt;Group&gt; allgroups = chain.getAtomGroups();
            for (Group group : groups) {
                if ( group instanceof AminoAcid) {
                    AminoAcid aa = (AminoAcid) group;
                    System.out.println(aa.getSecStruc());
                }
            }
</code></pre>
</div>

<h3 id="how-does-biojava-decide-what-groups-are-amino-acids">How does BioJava decide what groups are amino acids?</h3>

<p>BioJava supports the <a href="http://www.wwpdb.org/ccd.html">Chemical Components
Dictionary</a> which specifies the correct
representation of each group. Let’s take a look at how
<a href="http://en.wikipedia.org/wiki/Selenomethionine">Selenomethionine</a> and
water is dealt with:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>            Structure structure = StructureIO.getStructure("1A62");
                    
            for (Chain chain : structure.getChains()){
                for (Group group : chain.getAtomGroups()){
                    if ( group.getPDBName().equals("MSE") || group.getPDBName().equals("HOH")){
                        System.out.println(group.getPDBName() + " is a group of type " + group.getType());
                    }
                }
            }
</code></pre>
</div>

<p>This should give this output:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>MSE is a group of type amino
MSE is a group of type amino
MSE is a group of type amino
HOH is a group of type hetatm
HOH is a group of type hetatm
HOH is a group of type hetatm
...
</code></pre>
</div>

<p>As you can see, although MSE is flaged as HETATM in the PDB file,
BioJava still represents it correctly as an amino acid. They key is that
the <a href="http://www.rcsb.org/pdb/files/ligand/MSE.cif">definition file for
MSE</a> flags it as
“L-PEPTIDE LINKING”, which is being used by BioJava.</p>

<h3 id="how-to-access-chemical-component-definitions">How to access Chemical Component definitions</h3>

<p>Bye default BioJava ships with a minimal representation of standard
amino acids, however if you want to parse the whole PDB archive, it is
good to tell the library to either</p>

<ol>
  <li>fetch missing Chemical Component definitions on the fly (small
download and parsing delays every time a new chemical compound is
found), or</li>
  <li>Load all definitions at startup (slow startup, but then no further
delays later on, requires more memory)</li>
</ol>

<p>You can enable the first behaviour by doing using the
<a href="http://www.biojava.org/docs/api/org/biojava/nbio/structure/io/FileParsingParameters.html">FileParsingParameters</a>
class:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>            AtomCache cache = new AtomCache();
            
             // by default all files are stored at a temporary location.
            // you can set this either via at startup with -DPDB_DIR=/path/to/files/
            // or hard code it this way:
            cache.setPath("/tmp/");
            
            FileParsingParameters params = new FileParsingParameters();
            
            params.setLoadChemCompInfo(true);
            cache.setFileParsingParams(params);
            
            StructureIO.setAtomCache(cache);
            
            Structure structure = StructureIO.getStructure(...);
</code></pre>
</div>

<p>If you want to enable the second behaviour (slow loading of all chem
comps at startup, but no further small delays later on) you can use the
same code but change the behaviour by switching the
<a href="http://www.biojava.org/docs/api/org/biojava/nbio/structure/io/mmcif/ChemCompProvider.html">ChemCompProvider</a>
implementation in the
<a href="http://www.biojava.org/docs/api/org/biojava/nbio/structure/io/mmcif/ChemCompGroupFactory.html">ChemCompGroupFactory</a></p>

<div class="highlighter-rouge"><pre class="highlight"><code>     ChemCompGroupFactory.setChemCompProvider(new AllChemCompProvider());
</code></pre>
</div>
