<p><strong>Design for Alignment in BioJava3</strong></p>

<p>*Part of <gsoc:msa> Project by [Mark Chapman](Mark Chapman "wikilink")*</gsoc:msa></p>

<p>This page has a list of packages, interfaces, and classes to form the
basis of the BioJava3 alignment module. The new module ports <em>nearly</em>
all the current BioJava 1.7 alignment features to the BioJava3 standard.
Additional features prepare for the inclusion of multiple sequence
alignments.</p>

<p>The base data structures are immutable for efficiency with extensions to
mutable forms for JavaEE/Bean compliance. Simple factory methods reside
in the static Alignments class. A full interface hierarchy allows for
flexible customization and expansion.</p>

<h2 id="dependencies">Dependencies</h2>

<ul>
  <li>org.biojava3.core.sequence.location.template.Location</li>
  <li>org.biojava3.core.sequence.template.Compound</li>
  <li>org.biojava3.core.sequence.template.CompoundSet</li>
  <li>org.biojava3.core.sequence.template.Sequence</li>
</ul>

<h2 id="orgbiojava3alignment">org.biojava3.alignment</h2>

<h3 id="alignments">Alignments</h3>

<java>

` class Alignments // static utility`  
`   private Alignments() { } // prevents instantiation`  
`   List`&lt;Pair<s>`&gt; getAllPairsAlignments(List`<s extends="" sequence="">`)`  
`   int[] getAllPairsScores(List`&lt;? extends Sequence&gt;`)`  
`   Pair`<s extends="" sequence="">` getPairwiseAlignment(S, S)`  
`   int getPairwiseScore(Sequence, Sequence)`  
`   Profile`<s>` getMultipleSequenceAlignment(List`<s extends="" sequence="">`)`  
`   enum MSAEmulation { CLUSTALW, MUSCLE, KALIGN, CUSTOM }`  
`   class Defaults // static inner class`  
`     MSAEmulation getEmulation()`  
`     GapPenalty getGapPenalty()`  
`     Class`&lt;? extends HierarchicalClusterer&gt;` getHierarchicalClusterer()`  
`     Class`&lt;? extends PairwiseSequenceAligner&gt;` getPairwiseSequenceAligner()`  
`     Class`&lt;? extends PairwiseSequenceScorer&gt;` getPairwiseSequenceScorer()`  
`     Class`&lt;? extends PartitionRefiner&gt;` getPartitionRefiner()`  
`     Class`&lt;? extends ProfileProfileAligner&gt;` getProfileProfileAligner()`  
`     Class`&lt;? extends RescoreRefiner&gt;` getRescoreRefiner()`  
`     SubstitutionMatrix getSubstitutionMatrix()`  
`     void setEmulation(MSAEmulation)`  
`     void setGapPenalty(GapPenalty)`  
`     void setHierarchicalClusterer(Class`&lt;? extends HierarchicalClusterer&gt;`)`  
`     void setPairwiseSequenceAligner(Class`&lt;? extends PairwiseSequenceAligner&gt;`)`  
`     void setPairwiseSequenceScorer(Class`&lt;? extends PairwiseSequenceScorer&gt;`)`  
`     void setPartitionRefiner(Class`&lt;? extends PartitionRefiner&gt;`)`  
`     void setProfileProfileAligner(Class`&lt;? extends ProfileProfileAligner&gt;`)`  
`     void setRescoreRefiner(Class`&lt;? extends RescoreRefiner&gt;`)`  
`     void setSubstitutionMatrix(SubstitutionMatrix)`



### SimpleGapPenalty

<java>

` class SimpleGapPenalty implements GapPenalty`  
`   SimpleGapPenalty(short, short) // open, extend`

</java>

### SimpleSubstitutionMatrix

<java>

` class SimpleSubstitutionMatrix`<s extends="" compoundset="">` implements SubstitutionMatrix`<s>  
`   SimpleSubstitutionMatrix(File) // guess compound set from source`  
`   SimpleSubstitutionMatrix(String) // guess compound set from source`  
`   SimpleSubstitutionMatrix(S, File)`  
`   SimpleSubstitutionMatrix(S, short, short) // identity matrix (ignore or handle ambiguities?)`  
`   SimpleSubstitutionMatrix(S, String)`  
`   SimpleSubstitutionMatrix(S, String, String) // optional name parameter`  
`   String toString()`



### NeedlemanWunsch

<java>

` class NeedlemanWunsch`<s extends="" sequence="">` extends AbstractPairwiseSequenceAligner`<s>  
`   NeedlemanWunsch(S, S, GapPenalty, SubstitutionMatrix)`



### SmithWaterman

<java>

` class SmithWaterman`<s extends="" sequence="">` extends AbstractPairwiseSequenceAligner`<s>  
`   SmithWaterman(S, S, GapPenalty, SubstitutionMatrix)`



### FractionalIdentityScorer

<java>

` class FractionalIdentityScorer`<s extends="" sequence="">` implements PairwiseSequenceScorer`<s>  
`   FractionalIdentityScorer(SequencePair`<s>`)`



### FractionalSimilarityScorer

<java>

` class FractionalSimilarityScorer`<s extends="" sequence="">` implements PairwiseSequenceScorer`<s>  
`   FractionalSimilarityScorer(SequencePair`<s>`)`



### KmersScorer

<java>

` class KmersScorer`<s extends="" sequence="">` implements PairwiseSequenceScorer`<s>  
`   KmersScorer(S, S, int)`



### WuManberScorer

<java>

` class WuManberScorer`<s extends="" sequence="">` implements PairwiseSequenceScorer`<s>  
`   WuManberScorer(S, S, ?) // TODO: not sure of parameters`



### FractionalIdentityInProfileScorer

<java>

` class FractionalIdentityInProfileScorer`<s extends="" sequence="">` implements PairInProfileScorer`<s>  
`   FractionalIdentityInProfileScorer(S, S, Profile)`



### FractionalSimilarityInProfileScorer

<java>

` class FractionalSimilarityInProfileScorer`<s extends="" sequence="">` implements PairInProfileScorer`<s>  
`   FractionalSimilarityInProfileScorer(S, S, Profile)`



### GuideTree

<java>

` class GuideTree`<s extends="" sequence="">  
`   GuideTree(int[], List`<s>`, HierarchicalClusterer) // all pairs score`  
`   int[] getAllPairsScores()`  
`   float[][] getDistanceMatrix()`  
`   Node getRoot()`  
`   int[][] getScoreMatrix()`  
`   class Node`  
`     float getBranchLength1()`  
`     float getBranchLength2()`  
`     Node getChild1()`  
`     Node getChild2()`  
`     Node getParent()`  
`     S getSequence() // null unless isLeaf()`  
`     boolean isLeaf()`



### StandardRescoreRefiner

<java>

` class StandardRescoreRefiner`<s extends="" sequence="">` implements RescoreRefiner`<s>  
`   StandardRescoreRefiner(Profile, Class`&lt;? extends PairInProfileScorer<s>`&gt;, Class`&lt;? extends ProfileProfileAligner<s>`&gt;)`



### DayhoffRescoreRefiner

<java>

` class DayhoffRescoreRefiner`<s extends="" sequence="">` implements RescoreRefiner`<s>  
`   DayhoffRescoreRefiner(Profile, Class`&lt;? extends PairInProfileScorer<s>`&gt;, Class`&lt;? extends ProfileProfileAligner<s>`&gt;)`



### SinglePartitionRefiner

<java>

` class SinglePartitionRefiner`<s extends="" sequence="">` implements PartitionRefiner`<s>  
`   SinglePartitionRefiner(Profile, Class`&lt;? extends ProfileProfileAligner<s>`&gt;)`



### StochasticPartitionRefiner

<java>

` class StochasticPartitionRefiner`<s extends="" sequence="">` implements PartitionRefiner`<s>  
`   StochasticPartitionRefiner(Profile, Class`&lt;? extends ProfileProfileAligner<s>`&gt;)`



### TreeTraversalPartitionRefiner

<java>

` class TreeTraversalPartitionRefiner`<s extends="" sequence="">` implements PartitionRefiner`<s>  
`   TreeTraversalPartitionRefiner(Profile, Class`&lt;? extends ProfileProfileAligner<s>`&gt;)`



org.biojava3.alignment.template
-------------------------------

### GapPenalty

<java>

` interface GapPenalty`  
`   enum Type {CONSTANT, LINEAR, AFFINE} // gep = 0, gep = gop, gep != gop ... TODO: add DYNAMIC type`  
`   short getExtensionPenalty()`  
`   short getOpenPenalty()`  
`   Type getType()`  
`   void setExtensionPenalty(short)`  
`   void setOpenPenalty(short)`

</java>

### SubstitutionMatrix

<java>

` interface SubstitutionMatrix`&lt;S extends CompoundSet<c extends="" compound="">`&gt;`  
`   S getCompoundSet()`  
`   String getDescription()`  
`   short[][] getMatrix()`  
`   String getMatrixAsString()`  
`   short getMaxValue()`  
`   short getMinValue()`  
`   String getName()`  
`   short getValue(C, C)`  
`   void normalizeMatrix(short) // scale`  
`   void setDescription(String)`  
`   void setName(String)`



### AlignedSequence

<java>

` interface AlignedSequence`<c extends="" compound="">` extends Sequence`<c>  
`   int getAlignmentIndexAt(int)`  
`   int getEnd()`  
`   Location getLocationInAlignment()`  
`   int getNumGaps()`  
`   Sequence`<c>` getOriginalSequence()`  
`   int getOverlapCount() // if !isCircular() ? == 1 : &gt;= 1`  
`   int getSequenceIndexAt(int)`  
`   int getStart()`  
`   boolean isCircular()`



### MutableAlignedSequence

<java>

` interface MutableAlignedSequence`<c extends="" compound="">` extends AlignedSequence`<c>  
`   void setLocation(Location)`  
`   void shiftAtAlignmentLocation(Location, int)`  
`   void shiftAtSequenceLocation(Location, int)`



### Profile

<java>

` interface Profile`&lt;S extends Sequence<c extends="" compound="">`&gt; extends Iterable`<s>  
`   AlignedSequence`<c>` getAlignedSequence(int)`  
`   AlignedSequence`<c>` getAlignedSequence(S) // will find either aligned or original sequences`  
`   List`&lt;AlignedSequence<c>`&gt; getAlignedSequences() // unmodifiable unless class implements MutableProfile`  
`   List`&lt;AlignedSequence<c>`&gt; getAlignedSequences(int...) // useful for views`  
`   List`&lt;AlignedSequence<c>`&gt; getAlignedSequences(S...) // useful for views`  
`   C getCompoundAt(int, int)`  
`   C getCompoundAt(S, int) // will find either aligned or original sequences`  
`   List`<c>` getCompoundsAt(int) // useful for views`  
`   CompoundSet`<c>` getCompoundSet()`  
`   int[] getIndicesAt(int) // useful for views`  
`   int getIndexOf(C)`  
`   int getLastIndexOf(C)`  
`   int getLength() // number of columns`  
`   int getSize() // number of rows ... if !isCircular() ? == number of sequences : &gt;= number of sequences`  
`   ProfileView`<s>` getSubProfile(Location) // only include sequences that overlap Location`  
`   boolean isCircular() // if so, sequences longer than length() return multiple compounds at any location`  
`   String toString() // simple view: each sequence on 1 line`  
`   String toString(int) // formatted view: show start and end indices of profile and sequences, limited line length`



### MutableProfile

<java>

` interface MutableProfile`&lt;S extends Sequence<c extends="" compound="">`&gt; extends Profile`<s>  
`   // getAlignedSequences modifiable, full iterator with remove`  
`   void setSequences(List`&lt;AlignedSequence<c>`&gt;)`



### ProfileView

<java>

` interface ProfileView`&lt;S extends Sequence<c extends="" compound="">`&gt; extends Profile`<s>  
`   int getEnd()`  
`   int getStart()`  
`   Profile`<s>` getViewedProfile()`  
`   String toString() // simple view`  
`   String toString(int) // formatted view`



### SequencePair

<java>

` interface SequencePair`&lt;S extends Sequence<c extends="" compound="">`&gt; extends Profile`<s>  
`   C getCompoundInQueryAt(int)`  
`   C getCompoundInTargetAt(int)`  
`   int getIndexInQueryAt(int)`  
`   int getIndexInQueryForTargetAt(int)`  
`   int getIndexInTargetAt(int)`  
`   int getIndexInTargetForQueryAt(int)`  
`   int getNumIdenticals()`  
`   int getNumSimilars()`  
`   AlignedSequence`<c>` getQuery()`  
`   AlignedSequence`<c>` getTarget()`



### MutableSequencePair

<java>

` interface MutableSequencePair`<s extends="" sequence="">` extends MutableProfile`<s>`, SequencePair`<s>  
`   void setPair(AlignedSequence`<c>`, AlignedSequence`<c>`)`  
`   void setQuery(AlignedSequence`<c>`)`  
`   void setTarget(AlignedSequence`<c>`)`



### AbstractSequencePair

<java>

` abstract class AbstractSequencePair`<s extends="" sequence="">` implements SequencePair`<s>  
`   float getPercentGapsQuery()`  
`   float getPercentGapsTarget()`  
`   float getPercentIdentityQuery()`  
`   float getPercentIdentitySubject()`  
`   float getPercentSimilarityQuery()`  
`   float getPercentSimilaritySubject()`



### ProfilePair

<java>

` interface ProfilePair`<s extends="" sequence="">` extends Profile`<s>  
`   Profile`<s>` getQuery()`  
`   Profile`<s>` getTarget()`



### MutableProfilePair

<java>

` interface MutableProfilePair`<s extends="" sequence="">` extends MutableProfile`<s>`, ProfilePair`<s>  
`   void setPair(Profile`<s>`, Profile`<s>`)`  
`   void setQuery(Profile`<s>`)`  
`   void setTarget(Profile`<s>`)`



### Scorer

<java>

` interface Scorer // resides in core module`  
`   int getMaxScore()`  
`   int getMinScore()`  
`   int getScore()`

</java>

### PairwiseSequenceScorer

<java>

` interface PairwiseSequenceScorer`<s extends="" sequence="">` extends Scorer`  
`   SequencePair`<s>` getPair()`



### PairInProfileScorer

<java>

` interface PairInProfileScorer`<s extends="" sequence="">` extends PairwiseSequenceScorer`<s>  
`   Profile`<s>` getProfile()`



### ProfileProfileScorer

<java>

` interface ProfileProfileScorer`<s extends="" sequence="">` extends Scorer`  
`   ProfilePair`<s>` getPair()`



### Aligner

<java>

` interface Aligner`<s extends="" sequence="">` extends Scorer`  
`   long getComputationTime()`  
`   Profile`<s>` getProfile()`



### MatrixAligner

<java>

` interface MatrixAligner`<s extends="" sequence="">` extends Aligner`<s>  
`   short[][] getScoreMatrix()`  
`   short getScoreMatrixAt(int, int)`  
`   String getScoreMatrixAsString()`



### PairwiseSequenceAligner

<java>

` interface PairwiseSequenceAligner`<s extends="" sequence="">` extends MatrixAligner`<s>`, PairwiseSequenceScorer`<s>  
`   // combines 2 interfaces`



### ProfileProfileAligner

<java>

` interface ProfileProfileAligner`<s extends="" sequence="">` extends MatrixAligner`<s>`, ProfileProfileScorer`<s>  
`   // combines 2 interfaces`



### RescoreRefiner

<java>

` interface RescoreRefiner`<s extends="" sequence="">` extends Aligner`<s>`, ProfileProfileScorer`<s>  
`   Class`&lt;? extends PairInProfileScorer<s>`&gt; getPairInProfileScorer()`  
`   Class`&lt;? extends ProfileProfileAligner<s>`&gt; getProfileProfileAligner()`



### PartitionRefiner

<java>

` interface PartitionRefiner`<s extends="" sequence="">` extends Aligner`<s>`, ProfileProfileScorer`<s>  
`   Class`&lt;? extends ProfileProfileAligner<s>`&gt; getProfileProfileAligner()`



### AbstractPairwiseSequenceAligner

<java>

` abstract class AbstractPairwiseSequenceAligner`<s extends="" sequence="">` implements PairwiseSequenceAligner`<s>  
`   AbstractPairwiseSequenceAligner(S, S, GapPenalty, SubstitutionMatrix)`  
`   GapPenalty getGapPenalty()`  
`   SubstitutionMatrix getSubstitutionMatrix()`



### AbstractMutablePairwiseSequenceAligner

<java>

` abstract class AbstractMutablePairwiseSequenceAligner`<s extends="" sequence="">` extends AbstractPairwiseSequenceAligner`<s>` implements MutablePairwiseSequenceAligner`<s>  
`   AbstractMutablePairwiseSequenceAligner()`  
`   AbstractMutablePairwiseSequenceAligner(S, S, GapPenalty, SubstitutionMatrix)`  
`   void setGapPenalty(GapPenalty)`  
`   void setSubstitutionMatrix(SubstitutionMatrix)`



org.biojava3.alignment.views
----------------------------

### SimpleProfileView

<java>

` class SimpleProfileView`<s extends="" sequence="">` implements ProfileView`<s>  
`   SimpleProfileView(Profile`<s>`, int, int)`



### CompoundCountsView

<java>

` class CompoundCountsView`<s extends="" sequence="">` extends SimpleProfileView`<s>  
`   CompoundCountsView(Profile`<s>`)`  
`   CompoundCountsView(Profile`<s>`, int, int)`  
`   int[] getCompoundCountsAt(int) // returned array is size of CompoundSet`



### CompoundWeightsView

<java>

` class CompoundWeightsView`<s extends="" sequence="">` extends SimpleProfileView`<s>  
`   CompoundWeightsView(Profile`<s>`)`  
`   CompoundWeightsView(Profile`<s>`, int, int)`  
`   float[] getCompoundWeightsAt(int) // returned array is size of CompoundSet`



### ConsensusView

<java>

` class ConsensusView`<s extends="" sequence="">` extends SimpleProfileView`<s>  
`   ConsensusView(Profile`<s>`)`  
`   ConsensusView(Profile`<s>`, int, int)`  
`   S getConsensusSequence()`



org.biojava3.core.util
----------------------

### ConcurrencyTools

<java>

` class ConcurrencyTools // static utility`  
`   private ConcurrencyTools() { } // prevents instantiation`  
`   ExecutorService getThreadPool()`  
`   void setThreadPoolDefault()`  
`   void setThreadPoolSingle()`  
`   void setThreadPool(ExecutorService)`  
`   void shutdown()`  
`   void shutdownAndAwaitTermination()`  
`   Future`<t>` submit(Callable`<t>`, String)`  
`   Future`<t>` submit(Callable`<t>`)`  
`   // TODO: additional logging and listening services`



### LoggingTools

<java>

` class LoggingTools // static utility`  
`   private LoggingTools() { } // prevents instantiation`

</java>

Questions / Comments
--------------------

Where should indexing start with the bio default of 1 rather than the
Java standard of 0?

*Please add comments here...*
</t></t></t></t></java></s></s></s></s></java></s></s></s></s></java></s></s></s></s></java></s></s></s></java></s></s></s></java></s></s></java></s></s></s></s></java></s></s></s></s></s></java></s></s></s></java></s></s></s></java></s></s></java></s></s></java></s></s></java></s></s></s></java></s></s></java></s></s></s></s></s></s></s></java></s></s></s></s></java></s></s></java></c></c></c></c></s></s></s></java></c></c></s></c></java></s></s></c></java></c></s></c></java></s></c></c></c></c></c></c></c></s></c></java></c></c></java></c></c></c></java></c></java></s></s></s></java></s></s></s></java></s></s></s></java></s></s></s></s></java></s></s></s></s></java></s></s></java></s></s></java></s></s></java></s></s></java></s></s></java></s></s></s></java></s></s></s></java></s></s></java></s></s></java></s></s></java></s></s></s></s></s></java>
