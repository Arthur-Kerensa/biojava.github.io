<p>The architecture of the <em>RCSB MBT Libs</em> is a blend of two well
understood architectures:</p>

<ul>
  <li><em>App/Mainframe/Document</em>, and</li>
  <li><em>Model/View/Controller</em></li>
</ul>

<p>The <em>App/Mainfame/Document</em> structure is especially suited to desktop
applications (of which the <em>RCSB Viewer</em> derivatives belong) and should
be familiar to anyone who has worked with a mainstream windowing system,
such as Microsoft’s <em>C++/MFC</em>, <em>C#/Forms (application)</em> framework,
<em>PowerPlant</em> on the <em>Mac</em>, <em>Viewkit</em> on <em>IRIX</em>, etc.</p>

<p>We also like to think in terms of <em>Model/View/Controller</em>, and we can
blend the two notions as follows:’’</p>

<p><img src="MBTArchAMDToMVC.png" alt="" title="fig:MBTArchAMDToMVC.png" /></p>

<p>From here, it is easy to determine where most systems fit into the
architecture, and how to extend it, gracefully.</p>

<p>(Note that <em>Architecture</em> does not necessarily follow <em>Source Division</em>,
which is described in the previous chapter, although there is overlap.)</p>

<h2 id="architectural-components-overview">Architectural Components Overview</h2>

<p>A quick overview of the architectural components that make up the MBT
(and is reflected up through the viewers) can be ascertained from the
following diagram:</p>

<p><img src="MBTSingleFrameContainmentArch.png" alt="" title="fig:MBTSingleFrameContainmentArch.png" /></p>

<p>The component breakout, with a brief explanation of each is as follows:</p>

<p>App/Master Controller</p>

<!-- -->

<p>The <em>app</em> class (in the viewers, derived from <em>VFAppBase</em> from the
<em>Viewer Framework</em> project) is the focal point of the application. The
main is typically attached to the derivation of this class. The derived
class is typically named the same as the application.</p>

<!-- -->

<p>This class is the means by which all of the other components (directly
or indirectly) are accessed. Typical components are
the<em>Mainframe/DocumentFrame</em> and various controllers.</p>

<!-- -->

<p>Mainframe/DocumentFrame</p>

<!-- -->

<p>Applications typically have a main frame (or window) which contains a
representation of the document. We introduce the notion of
‘DocumentFrame’ to distinguish it from ‘Mainframe’ for reasons we will
discuss, later. For now, the entities are one and the same.</p>

<!-- -->

<p>The ‘DocumentFrame’’ contains UI necessary to contain, display, and
possibly interact with the document (such as control panels, menus,
etc.) In that sense, it acts as a ‘views controller’.</p>

<!-- -->

<p>It is also the access point for the <em>model</em> and doc-centric
<em>controllers</em> (controllers that control some aspect of the document’s
<em>model</em>, vs. controllers that may act globally or on other parts of the
application.)</p>

<!-- -->

<p>Note that by associating the <em>model</em> and doc-centric <em>controllers</em> with
a frame, we now are free to expand the above <em>single-framed</em>
representation to a <em>multiple-framed</em> representation:</p>

<p><img src="MBTMDIContainmentArch.png" alt="" title="fig:MBTMDIContainmentArch.png" /></p>

<p>This is simply a repeated structure for each <em>DocumentFrame</em>, with the
addition of two more components:</p>

<p>:*A <em>Multiple Frame Controller</em> (not implemented this version.) This
component (would do) the following:</p>

<p>::*Create the <em>Document Frames</em> as they are requested.</p>

<p>::*Provide access to the <em>DocumentFrames</em>, as well as their contained
components.</p>

<p>::*Maintains ‘active frame’ status (most access requests will be via
the active frame.)</p>

<p>:*'’Separated ‘Other UI’ ‘’ - UI that is not tied to a document, or is
updated when the active <em>Document Frame</em> changes. An example would be a
control panel that is not in a document frame.</p>

<p>An example multiple frame doc controller can be found in the <em>TestBed</em>
project.</p>

<!-- -->

<p>Model<br />
An instance of the data that defines the model. Currently an array of
structures.</p>

<!-- -->

<p>Controllers (doc-centric)</p>

<!-- -->

<p>There are a number of these to control subfunctions/systems. Currently,
these are:</p>

<p>:*<em>DocController</em> - controls the document, in particular
loading/saving.</p>

<p>:*<em>UpdateController</em> - controls change updates sent to registered
listeners.</p>

<p>:*<em>SceneController</em> - controls creation, access and changes to the
scene.</p>

<p>:*<em>StateController</em> - controls state attributes of the document.</p>

<p>:*<em>MutatorController</em> - controls changes to the document.</p>

<p>More are expected to be added as functionality grows or functional units
are further identified.</p>

<p>GlViewer</p>

<!-- -->

<p>The 3d viewer, attached to the <em>DocumentFrame</em>. Renders the scene.</p>

<!-- -->

<p>Other UI</p>

<!-- -->

<p>Loose definition for various other views/panels/dialogs that are related
to the document.</p>

