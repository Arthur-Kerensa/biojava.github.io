<h3 id="comment-faire-pour-lire-un-fichier-de-type-pdb">Comment faire pour lire un fichier de type PDB?</h3>

<p>La <a href="http://www.pdb.org"><em>Protein Data Bank</em></a> est la principale source de
données struturales disponible sur l’Internet. Contrairement aux
fichiers de type GenBank ou EMBL qui contiennent des donnés de séquence,
les fichiers PDB contiennent plutôt des données de position d’atomes au
sein d’une structure 3D.</p>

<p>BioJava contient un modèle flexible permettant la gestion des données de
structure contenues dans un fichier PDB. Les exemples ci-dessous
montrent comment:</p>

<ul>
  <li>créer et manipuler une repertoire PDB local ou</li>
  <li>faire la lecture d’un fichier PDB à partir d’un système de fichiers
local.</li>
</ul>

<p>Les fonctionnalités de base de cette capacité sont retrouvés dans la
classe
<a href="http://www.biojava.org/docs/api/index.html?org/biojava/bio/structure/io/PDBFileReader.html">PDBFileReader</a>.</p>

<h2 id="exemple-bref-la-manire-rapide-de-lire-un-fichier-local">Exemple bref: la manière rapide de lire un fichier local</h2>

<java>

`// fonctionne egalement sur le fichiers compressés en gzip`  
`String filename =  "path/to/pdbfile.ent" ;`  
  
`PDBFileReader pdbreader = new PDBFileReader();`

`try{`

`    Structure struc = pdbreader.getStructure(filename);`  
`    `  
`} catch (Exception e){`  
`    e.printStackTrace();`  
`}`

</java>

<h2 id="exemple-utilisation-dune-installation-locale-de-pdb">Exemple: Utilisation d’une installation locale de PDB</h2>

<java>

`   try {`  
`       PDBFileReader reader = new PDBFileReader();`

`       // Le chemin vers l'installation PDB locale`  
`       reader.setPath("/tmp");`  
`           `  
`       // Est-ce que tous les fichiers sont sous un seul répertoireare `  
`               // ou sont-ils divisés comme sur les serveurs FTP de PDB?`  
`       reader.setPdbDirectorySplit(true);`  
`           `  
`       // Faut-il aller récupérer un fichier PDB manquant `  
`               // automatiquement via FTP?`  
`       reader.setAutoFetch(true);`  
`           `  
`       // Devons nous aligner les residues ATOM et SEQRES`  
`       // a la creation du modele interne?`  
`               reader.setAlignSeqRes(false);`  
`           `  
`       // Devons-nous lire les infos de structure secondaire`  
`               // incluses dans le fichier?`  
`       reader.setParseSecStruc(false);`  
`           `  
`       Structure structure = reader.getStructureById("4hhb");`  
`           `  
`       System.out.println(structure);`  
`           `  
`   } catch (Exception e){`  
`       e.printStackTrace();`  
`   }`

</java>

<p>L’exemple ci-dessus produira la sortie suivante:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Fetching ftp://ftp.wwpdb.org/pub/pdb/data/structures/all/pdb/pdb4hhb.ent.gz
writing to /tmp/hh/pdb4hhb.ent.gz
structure  4HHB Authors: G.FERMI,M.F.PERUTZ Resolution: 1.74 Technique: X-RAY DIFFRACTION  Classification: OXYGEN TRANSPORT DepDate: Wed Mar 07 00:00:00 PST 1984 IdCode: 4HHB Title: THE CRYSTAL STRUCTURE OF HUMAN DEOXYHAEMOGLOBIN AT 1.74 ANGSTROMS RESOLUTION ModDate: Tue Feb 24 00:00:00 PST 2009 
 chains:
chain 0: &gt;A&lt; HEMOGLOBIN (DEOXY) (ALPHA CHAIN)
 length SEQRES: 0 length ATOM: 198 aminos: 141 hetatms: 57 nucleotides: 0
chain 1: &gt;B&lt; HEMOGLOBIN (DEOXY) (BETA CHAIN)
 length SEQRES: 0 length ATOM: 205 aminos: 146 hetatms: 59 nucleotides: 0
chain 2: &gt;C&lt; HEMOGLOBIN (DEOXY) (ALPHA CHAIN)
 length SEQRES: 0 length ATOM: 201 aminos: 141 hetatms: 60 nucleotides: 0
chain 3: &gt;D&lt; HEMOGLOBIN (DEOXY) (BETA CHAIN)
 length SEQRES: 0 length ATOM: 197 aminos: 146 hetatms: 51 nucleotides: 0
DBRefs: 4
DBREF  4HHB A    1   141  UNP    P69905   HBA_HUMAN        1    141
DBREF  4HHB B    1   146  UNP    P68871   HBB_HUMAN        1    146
DBREF  4HHB C    1   141  UNP    P69905   HBA_HUMAN        1    141
DBREF  4HHB D    1   146  UNP    P68871   HBB_HUMAN        1    146
Molecules: 
Compound: 1 HEMOGLOBIN (DEOXY) (ALPHA CHAIN) Chains: ChainId: A C Engineered: YES OrganismScientific: HOMO SAPIENS OrganismTaxId: 9606 OrganismCommon: HUMAN 
Compound: 2 HEMOGLOBIN (DEOXY) (BETA CHAIN) Chains: ChainId: B D Engineered: YES OrganismScientific: HOMO SAPIENS OrganismTaxId: 9606 OrganismCommon: HUMAN 
</code></pre>
</div>

<h2 id="exemple-lecture-dun-fichier-local-en-format-pdb">Exemple: Lecture d’un fichier local en format PDB</h2>

<p>L’exemple suivant permet le lecture d’un fichier PDB à partir de votre
système de fichiers, la création d’un objet
<a href="http://www.biojava.org/docs/api/org/biojava/bio/structure/Structure.html">Structure</a>
et faire l’itération sur les objets
<a href="http://www.biojava.org/docs/api/org/biojava/bio/structure/Group.html">Groups</a>
qui sont contenu dans ce fichier. Pour les exemples d’accession aux
objets
<a href="http://www.biojava.org/docs/api/org/biojava/bio/structure/Atom.html">Atoms</a>,
voir <biojava:cookbookfrench:pdb:atom>. Pour plus d'informations sur la
gestion des informations SEQRES et ATOM, voir</biojava:cookbookfrench:pdb:atom></p>
<biojava:cookbookfrench:pdb:seqres>.

<java>

`// fonctionne egalement avec les fichiers`  
`// compresses par zip`  
`String filename =  "parcours/vers/pdbfile.ent" ;`  
  
`PDBFileReader pdbreader = new PDBFileReader();`  
  
`// optionel: le lecteur peut aussi lire les structure secondaires `  
`// tel que decrites dans l'en-tet du fichier PDB pour les ajouter`  
`// aux acides amines`  
`pdbread.setParseSecStruc(true);     `  
  
`try{`  
`    Structure struc = pdbreader.getStructure(filename);`  
`    `  
`    System.out.println(struc);`  
  
`    GroupIterator gi = new GroupIterator(struc);`  
  
`    while (gi.hasNext()){`  
  
`          Group g = (Group) gi.next();`  
`         `  
`          if ( g instanceof AminoAcid ){`  
`              AminoAcid aa = (AminoAcid)g;`  
`              Map sec = aa.getSecStruc();`  
`              Chain  c = g.getParent();`  
`              System.out.println(c.getName() + " " + g + " " + sec);`  
`          }                `  
`    }`  
  
`} catch (Exception e) {`  
`    e.printStackTrace();`  
`}`

</java>
</biojava:cookbookfrench:pdb:seqres>
