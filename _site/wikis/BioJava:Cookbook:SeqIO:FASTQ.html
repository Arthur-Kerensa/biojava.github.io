<h2 id="how-do-i-work-with-nextgen-sequencing-reads-in-fastq-format">How do I work with nextgen sequencing reads in FASTQ format?</h2>

<p>The org.biojava.bio.program.fastq package provides support for reading
and writing nextgen sequencing reads in FASTQ format (FastqReader and
FastqWriter, respectively) and for converting FASTQ sequences into
proper biojava Sequences for analysis purposes (FastqTools).</p>

<p>The following code snippets demonstrate how to use the APIs for common
use cases.</p>

<h3 id="convert-between-fastq-variants">Convert between FASTQ variants</h3>

<java> FastqReader fastqReader = new IlluminaFastqReader(); FastqWriter
fastqWriter = new SangerFastqWriter(); fastqWriter.write(new
File("sanger.fastq"), fastqReader.read(new File("illumina.fastq")));
</java>

<h3 id="convert-only-long-sequences">Convert only long sequences</h3>

<java> FastqReader fastqReader = new IlluminaFastqReader(); FastqWriter
fastqWriter = new SangerFastqWriter(); FileWriter fileWriter = new
FileWriter(new File("sanger.fastq"))));

for (Fastq fastq : fastqReader.read(new File("illumina.fastq"))) {

` if (fastq.getSequence().length() &gt; 16)`  
` {`  
`   fastqWriter.append(fileWriter, fastq);`  
` }`

} </java>

<h3 id="convert-between-fastq-variants-using-streaming-api">Convert between FASTQ variants using streaming API</h3>

<java> FastqReader fastqReader = new IlluminaFastqReader();
IlluminaInputSupplier inputSupplier = Files.newReaderSupplier(new
File("illumina.fastq")); final FastqWriter fastqWriter = new
SangerFastqWriter(); final FileWriter fileWriter = new FileWriter(new
File("sanger.fastq"))));

fastqReader.stream(inputSupplier, new StreamListener()

` {`  
`   @Override`  
`   public void fastq(final Fastq fastq)`  
`   {`  
`     fastqWriter.append(fileWriter, fastq);`  
`   }`  
` });`

</java>

<h3 id="convert-only-long-sequences-using-streaming-api">Convert only long sequences using streaming API</h3>

<java> IlluminaFastqReader fastqReader = new IlluminaFastqReader();
InputSupplier inputSupplier = Files.newReaderSupplier(new
File("illumina.fastq")); FastqWriter fastqWriter = new
SangerFastqWriter(); FileWriter fileWriter = new FileWriter(new
File("sanger.fastq"))));

fastqReader.stream(inputSupplier, new StreamListener()

` {`  
`   @Override`  
`   public void fastq(final Fastq fastq)`  
`   {`  
`     if (fastq.getSequence().length() &gt; 16)`  
`     {`  
`       fastqWriter.append(fileWriter, fastq);`  
`     }`  
`   }`  
` });`

</java>

<h3 id="count-sequences">Count sequences</h3>

<java> FastqReader fastqReader = new IlluminaFastqReader();

int count = 0; for (Fastq fastq : fastqReader.read(new
File("illumina.fastq"))) {

` count++:`

} System.out.println(count); </java>

<h3 id="count-sequences-using-streaming-api">Count sequences using streaming API</h3>

<java> IlluminaFastqReader fastqReader = new IlluminaFastqReader();
InputSupplier inputSupplier = Files.newReaderSupplier(new
File("illumina.fastq"));

final AtomicInteger count = new AtomicInteger();
fastqReader.stream(inputSupplier, new StreamListener()

` {`  
`   @Override`  
`   public void fastq(final Fastq fastq)`  
`   {`  
`     count.incrementAndGet();`  
`   }`  
` });`

System.out.println(count.get()); </java>

<h3 id="count-sequences-using-low-level-api">Count sequences using low-level API</h3>

<java> IlluminaFastqReader fastqReader = new IlluminaFastqReader();
InputSupplier inputSupplier = Files.newReaderSupplier(new
File("illumina.fastq"));

final AtomicInteger count = new AtomicInteger();
fastqReader.parse(inputSupplier, new ParseAdapter()

` {`  
`   @Override`  
`   public void complete() throws IOException`  
`   {`  
`     count.incrementAndGet();`  
`   }`  
` });`

System.out.println(count.get()); </java>

<h3 id="pattern-match-description-lines-using-low-level-api">Pattern match description lines using low-level API</h3>

<java> final Pattern pattern = Pattern.compile("^HWUSI-EAS100R:.\*$");
IlluminaFastqReader fastqReader = new IlluminaFastqReader();
InputSupplier inputSupplier = Files.newReaderSupplier(new
File("illumina.fastq"));

fastqReader.parse(inputSupplier, new ParseAdapter()

` {`  
`   @Override`  
`   public void description(final String description) throws IOException`  
`   {`  
`     if (pattern.matches(description))`  
`     {`  
`       System.out.println(description);`  
`     }`  
`   }`  
` });`

</java>

<h3 id="create-sequences-from-fastq-sequences">Create Sequences from FASTQ sequences</h3>

<java> FastqReader fastqReader = new SangerFastqReader(); List<sequence>
sequences = new LinkedList<sequence>();

for (Fastq fastq : fastqReader.read(new File("sanger.fastq"))) {

` sequences.add(FastqTools.createSequence(fastq));`

} 

### Create Sequences with streaming API

<java> SangerFastqReader fastqReader = new SangerFastqReader();
InputSupplier inputSupplier = Files.newReaderSupplier(new
File("sanger.fastq")); List<sequence> sequences = new
LinkedList<sequence>();

fastqReader.stream(inputSupplier, new StreamListener()

` {`  
`   @Override`  
`   public void fastq(final Fastq fastq)`  
`   {`  
`     sequences.add(FastqTools.createSequence(fastq));`  
`   }`  
` });`



### Create PhredSequences ([DNAxInteger] symbols) from FASTQ sequences

<java> FastqReader fastqReader = new SangerFastqReader();
List<phredsequence> sequences = new LinkedList<phredsequence>();

for (Fastq fastq : fastqReader.read(new File("sanger.fastq"))) {

` phredSequences.add(FastqTools.createPhredSequence(fastq));`

} 

### Create PhredSequences ([DNAxInteger] symbols) using streaming API

<java> SangerFastqReader fastqReader = new SangerFastqReader();
InputSupplier inputSupplier = Files.newReaderSupplier(new
File("sanger.fastq")); List<phredsequence> sequences = new
LinkedList<phredsequence>();

fastqReader.stream(inputSupplier, new StreamListener()

` {`  
`   @Override`  
`   public void fastq(final Fastq fastq)`  
`   {`  
`     sequences.add(FastqTools.createPhredSequence(fastq));`  
`   }`  
` });`



### Calculate mean p scores using streaming API

<java> SangerFastqReader fastqReader = new SangerFastqReader();
InputSupplier inputSupplier = Files.newReaderSupplier(new
File("sanger.fastq")); SummaryStatistics stats = new
SummaryStatistics(); StringBuilder sb = new StringBuilder(512);

fastqReader.stream(inputSupplier, new StreamListener()

` {`  
`   @Override`  
`   public void fastq(final Fastq fastq)`  
`   {`  
`     stats.clear();`  
`     for (Double errorProbability : FastqTools.errorProbabilities(fastq))`  
`     {`  
`       stats.addValue(errorProbability);`  
`     }`  
`     sb.delete(0, sb.length());`  
`     sb.append(fastq.getDescription());`  
`     sb.append("\t");`  
`     sb.append(stats.getMean());`  
`     sb.append("\t");`  
`     sb.append(stats.getStandardDeviation());`  
`     System.out.println(sb.toString());`  
`   }`  
` });`

</java>

### Calculate mean p scores using streaming API and double array

<java> SangerFastqReader fastqReader = new SangerFastqReader();
InputSupplier inputSupplier = Files.newReaderSupplier(new
File("sanger.fastq")); SummaryStatistics stats = new
SummaryStatistics(); StringBuilder sb = new StringBuilder(512);

fastqReader.stream(inputSupplier, new StreamListener()

` {`  
`   @Override`  
`   public void fastq(final Fastq fastq)`  
`   {`  
`     stats.clear();`  
`     int size = fastq.getSequence().length();`  
`     double[] errorProbabilities = FastqTools.errorProbabilties(fastq, new double[size]);`  
`     for (int i = 0; i &lt; size; i++)`  
`     {`  
`       stats.addValue(errorProbabilities[i]);`  
`     }`  
`     sb.delete(0, sb.length());`  
`     sb.append(fastq.getDescription());`  
`     sb.append("\t");`  
`     sb.append(stats.getMean());`  
`     sb.append("\t");`  
`     sb.append(stats.getStandardDeviation());`  
`     System.out.println(sb.toString());`  
`   }`  
` });`

</java>
</phredsequence></phredsequence></java></phredsequence></phredsequence></java></sequence></sequence></java></sequence></sequence></java>
